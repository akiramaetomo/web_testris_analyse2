<!DOCTYPE html>
<html lang="ja">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="UTF-8" />
    <title>Tetris with Lock Delay and Separated Sounds</title>
    <style>

        #bgCanvas {
            position: fixed;
            /* スクロールしても動かない最背面レイヤー */
            inset: 0;
            /* 画面全体を覆う */
            z-index: 0;
            /* 他レイヤーより背面。必要なら -1 でも可 */
            pointer-events: none;
            /* クリックを透過させる */
        }

        #gameContainer {
            /* 既存ゲーム領域を前面へ */
            position: relative;
            z-index: 1;
        }



        /* ★[全体デザイン]: ページ全体の背景など */
        body {
            background-color: #001d3b;
            /* ダークグレー背景 */
            margin: 0;
            padding: 0;
            font-family: sans-serif;
        }

        /* ★[レイアウト1] メインコンテナを横並びに */
        #gameContainer {
            display: flex;
            flex-direction: row;
            margin: 20px;
            justify-content: center;
            align-items: flex-start;
        }

        /* ゲーム統計情報表示領域 */
        #statsArea {
            width: 100px;
            background-color: #222;
            color: #fff;
            padding: 10px;
            box-sizing: border-box;
            font-size: 14px;
            margin-right: 20px;
            text-align: left;
        }

        /* ★[左側エリア]: ゲームCanvas */
        #leftArea {
            display: flex;
            flex-direction: column;
            margin-right: 20px;
            /* 右側との間隔 */
        }

        /* ゲームCanvas（壁＋プレイ領域） */
        #gameCanvas {
            background-color: #000;
            border: 2px solid #222;
            display: block;
        }

        /* ★[右側エリア]: 縦に並べて次ブロックCanvas＆ダミー領域 */
        #rightArea {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            /* 左寄せ */
        }

        /* 次ブロックCanvas: 幅80×高さ80に固定(4×4マスを想定) */
        #nextCanvas {
            background-color: #000;
            border: 2px solid #222;
            display: block;
            margin-bottom: 20px;
        }

        /* ダミー領域(将来的にスコアや各種情報を表示) */
        #infoArea {
            width: 80px;
            height: 200px;
            background-color: #333;
            /* 薄暗い背景 */
            color: #fff;
            padding: 5px;
            box-sizing: border-box;
            font-size: 10px;
        }
    /* touch controls portrait */
    @media (max-width: 768px) and (orientation: portrait) {
      #touchControls {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 2;
      }
      .controls-group {
        position: absolute;
        pointer-events: auto;
        display: flex;
        gap: 8px;
      }
      /* initial left controls removed */
      .controls-group.center {
        bottom: 16px;
        left: 50%;
        transform: translateX(-50%);
      }
      /* initial right controls removed */
      .control-button {
        width: 48px;
        height: 48px;
        border-radius: 8px;
        background: rgba(255,255,255,0.2);
        color: white;
        font-size: 18px;
      }
      /* leftArea vertical layout */
      #leftArea {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      /* right controls row layout */
      .controls-group.right {
        display: flex;
        flex-direction: row;
        gap: 8px;
      }
      /* cross shape for left controls */
      .controls-group.left {
        display: grid;
        grid-template-columns: repeat(3, 48px);
        grid-template-rows: repeat(3, 48px);
        gap: 8px;
      }
      .controls-group.left [data-action="move_up"]    { grid-area: 1 / 2; }
      .controls-group.left [data-action="move_left"]  { grid-area: 2 / 1; }
      .controls-group.left [data-action="move_down"]  { grid-area: 3 / 2; }
      .controls-group.left [data-action="move_right"] { grid-area: 2 / 3; }
    }
    </style>
</head>

<body tabindex="0">
    <div id="touchControls">
      <div class="controls-group left">
        <button class="control-button" data-action="move_left">◀</button>
        <button class="control-button" data-action="move_up">▲</button>
        <button class="control-button" data-action="move_down">▼</button>
        <button class="control-button" data-action="move_right">▶</button>
      </div>
      <div class="controls-group center">
        <button class="control-button" data-action="back">⟲</button>
        <button class="control-button" data-action="start">▶</button>
      </div>
      <div class="controls-group right">
        <button class="control-button" data-action="rotate_l">X</button>
        <button class="control-button" data-action="rotate_r">B</button>
      </div>
    </div>
    <canvas id="bgCanvas"></canvas>


        <div id="gameContainer">
            <div id="statsArea"></div>
        <!-- ★[左エリア]: ゲームCanvasを配置 -->
        <div id="leftArea">
<canvas id="gameCanvas" tabindex="0"></canvas>
        </div>

        <!-- ★[右エリア]: 縦に並べて、上=次ブロックCanvas、下=ダミー領域 -->
        <div id="rightArea">
            <canvas id="nextCanvas" width="160" height="160"></canvas>
            <div id="infoArea">
                ここはダミー領域(スコア表示などに活用予定)
            </div>
        </div>
    </div>


    <!-- 負荷率表示用 -->
    <div id="perfStats" style="position:absolute; right:8px; top:8px;
           color:#0f0; font:12px monospace; pointer-events:none;
           background:rgba(0,0,0,.35); padding:2px 4px;
           display:none;">
    </div>



    <!-- ★[サウンド定義]: 以前ここで行っていたが削除。soundManager.jsにて実施 -->

    <!-- ★ 外部JavaScriptファイルを読み込み -->
    <script type="module" src="assets/js/main.js"></script>

</body>

</html>
